https://cloud.google.com/vision/pricing?utm_source=chatgpt.com&hl=ja


ğŸ“Š 100 ä¸‡ãƒšãƒ¼ã‚¸ OCR ã®è¨ˆç®—
åŸºæœ¬å˜ä¾¡ï¼ˆ1.5ãƒ‰ãƒ«/1000ï¼‰
1,000,000 / 1,000 Ã— $1.50 = $1,500


ğŸ‘‰ ç´„ $1,500 / æœˆ

å¤§é‡å‰²å¼•å¾Œï¼ˆ5Mè¶…ï¼‰

100 ä¸‡ã¯å‰²å¼•å¯¾è±¡å¤–

500 ä¸‡ä»¥ä¸Šã¯ $0.60 ã«ä¸‹ãŒã‚‹

ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼

å…¨ä½“åƒï¼ˆæœ€åˆã«ä¿¯ç°ï¼‰

Google Vision OCRã§PDFã‚’OCRã™ã‚‹æ­£è§£ãƒ«ãƒ¼ãƒˆã¯ã“ã‚Œä¸€æŠã§ã™

ãƒ­ãƒ¼ã‚«ãƒ«PDF
   â†“
GCSã«ä¸€æ™‚ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
   â†“
Vision APIï¼ˆDocument Text Detectionãƒ»éåŒæœŸï¼‰
   â†“
OCRçµæœ(JSON)å–å¾—
   â†“
å¿…è¦ãªæ–‡å­—ã‚’Pythonã§æŠ½å‡º
   â†“
GCSã®PDFã‚’å‰Šé™¤


âš ï¸ PDFã¯å¿…ãšéåŒæœŸAPI + GCSå¿…é ˆ
ï¼ˆã“ã‚Œã¯ä»•æ§˜ã§ã€å›é¿ä¸å¯ï¼‰

â‘  Google Cloud ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆï¼ˆåˆå›ã®ã¿ï¼‰

https://console.cloud.google.com/

å³ä¸Šã€Œãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã€

åå‰ã¯ä½•ã§ã‚‚OKï¼ˆä¾‹ï¼šocr-testï¼‰

â‘¡ Vision API ã‚’æœ‰åŠ¹åŒ–

å·¦ãƒ¡ãƒ‹ãƒ¥ãƒ¼ â†’ APIã¨ã‚µãƒ¼ãƒ“ã‚¹

ã€Œãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€

Cloud Vision API

æœ‰åŠ¹ã«ã™ã‚‹

âœ” ã“ã“ã§åˆã‚ã¦OCRãŒä½¿ãˆã‚‹

â‘¢ ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆï¼ˆè¶…é‡è¦ï¼‰

IAMã¨ç®¡ç† â†’ ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ

ã€Œã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½œæˆã€

åå‰ï¼švision-ocr-sa

ãƒ­ãƒ¼ãƒ«ã‚’ä»˜ä¸ï¼š

Cloud Vision API User

Storage Object Admin

ã‚­ãƒ¼ä½œæˆ

å½¢å¼ï¼šJSON

ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ï¼ˆè¶…é‡è¦ï¼‰

ğŸ‘‰ ã“ã®JSONãŒ Pythonã‹ã‚‰APIã‚’å©ãéµ

â‘£ GCSãƒã‚±ãƒƒãƒˆä½œæˆï¼ˆ1ã¤ã ã‘ï¼‰

Cloud Storage â†’ ãƒã‚±ãƒƒãƒˆ

ä½œæˆ

åå‰ï¼šä¾‹ ocr-temp-bucket-12345

ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ï¼šusï¼ˆVisionã¨ç›¸æ€§â—ï¼‰

ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚¯ãƒ©ã‚¹ï¼šStandard

ä½œæˆ

â‘¤ ãƒ­ãƒ¼ã‚«ãƒ«ã«Pythonç’°å¢ƒæº–å‚™
pip install google-cloud-vision google-cloud-storage

â‘¥ èªè¨¼æƒ…å ±ã‚’Pythonã«èªè­˜ã•ã›ã‚‹
Windows
set GOOGLE_APPLICATION_CREDENTIALS=C:\path\to\vision-ocr-sa.json

macOS / Linux
export GOOGLE_APPLICATION_CREDENTIALS=/path/to/vision-ocr-sa.json

â‘¦ PDFã‚’GCSã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼ˆPythonï¼‰
from google.cloud import storage

bucket_name = "ocr-temp-bucket-12345"
local_pdf = "test.pdf"
gcs_pdf = "input/test.pdf"

client = storage.Client()
bucket = client.bucket(bucket_name)
blob = bucket.blob(gcs_pdf)

blob.upload_from_filename(local_pdf)

print("PDF uploaded")

â‘§ Vision OCRï¼ˆDocument Text Detectionãƒ»éåŒæœŸï¼‰

ã“ã‚ŒãŒ æ ¸å¿ƒ ã§ã™ã€‚

from google.cloud import vision_v1 as vision

client = vision.ImageAnnotatorClient()

gcs_source_uri = "gs://ocr-temp-bucket-12345/input/test.pdf"
gcs_destination_uri = "gs://ocr-temp-bucket-12345/output/"

feature = vision.Feature(
    type_=vision.Feature.Type.DOCUMENT_TEXT_DETECTION
)

gcs_source = vision.GcsSource(uri=gcs_source_uri)
input_config = vision.InputConfig(
    gcs_source=gcs_source,
    mime_type="application/pdf"
)

gcs_destination = vision.GcsDestination(uri=gcs_destination_uri)
output_config = vision.OutputConfig(
    gcs_destination=gcs_destination,
    batch_size=1
)

async_request = vision.AsyncAnnotateFileRequest(
    features=[feature],
    input_config=input_config,
    output_config=output_config
)

operation = client.async_batch_annotate_files(
    requests=[async_request]
)

print("OCR processing...")
operation.result(timeout=300)
print("OCR done")


âœ” æ—¥æœ¬èªå¸³ç¥¨ â†’ ã“ã‚ŒãŒæœ€ã‚‚ç²¾åº¦ãŒå‡ºã‚‹

â‘¨ OCRçµæœ(JSON)ã‚’å–å¾—
import json
from google.cloud import storage

client = storage.Client()
bucket = client.bucket(bucket_name)

blobs = bucket.list_blobs(prefix="output/")

for blob in blobs:
    if blob.name.endswith(".json"):
        content = blob.download_as_text()
        data = json.loads(content)

        text = data["responses"][0]["fullTextAnnotation"]["text"]
        print("===== OCR RESULT =====")
        print(text)


ğŸ‘‰ ã“ã‚Œã§PDFå…¨ãƒšãƒ¼ã‚¸ã®æ—¥æœ¬èªãƒ†ã‚­ã‚¹ãƒˆãŒ1ã¤ã®æ–‡å­—åˆ—ã¨ã—ã¦å–å¾—å¯èƒ½

â‘© GCSã®PDFã‚’å‰Šé™¤ï¼ˆæ¨å¥¨ï¼‰
bucket.blob(gcs_pdf).delete()
print("PDF deleted")


ï¼ˆçµæœJSONã¯æ®‹ã—ã¦ã‚‚OKï¼‰

â‘ª ã‚ˆãã‚ã‚‹è½ã¨ã—ç©´ï¼ˆé‡è¦ï¼‰
å•é¡Œ	åŸå› 
æ—¥æœ¬èªãŒå´©ã‚Œã‚‹	TEXT_DETECTIONã‚’ä½¿ã£ã¦ã„ã‚‹
ç²¾åº¦ãŒä½ã„	åŒæœŸAPIã‚’ä½¿ã£ã¦ã„ã‚‹
ã‚¨ãƒ©ãƒ¼	GCSã‚’ä½¿ã£ã¦ã„ãªã„
èªè¨¼ã‚¨ãƒ©ãƒ¼	JSONã‚­ãƒ¼æœªè¨­å®š

ğŸ‘‰ Document Text Detection + éåŒæœŸ + GCS
ã“ã‚Œä»¥å¤–ã¯ä½¿ã‚ãªã„ã§ãã ã•ã„ã€‚

â‘« ç„¡æ–™æ ã«ã¤ã„ã¦ï¼ˆå†ç¢ºèªï¼‰

æœˆ1000ãƒšãƒ¼ã‚¸ã¾ã§ç„¡æ–™

ã‚¯ãƒ¬ã‚«ç™»éŒ²ãªã—ã§ã‚‚å¯èƒ½ï¼ˆãŸã ã—åˆ¶é™ã‚ã‚Šï¼‰

å®Ÿå‹™åˆ©ç”¨å‰ã«ã¯èª²é‡‘å¿…é ˆ
