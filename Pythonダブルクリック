🟢 Anaconda前提・共有ファイルサーバ実行の“鉄板構成”

前提：

Anacondaは 各自のPCにローカルインストール

ツール一式は 共有ファイルサーバに配置

実行は batダブルクリック

📁 フォルダ構成（共有サーバ上）
\\fileserver\share\mytool\
├── main.py
├── requirements.txt
└── run.bat   ← ダブルクリック用

① Anacondaを各自のPCにインストール

配布URL：

https://www.anaconda.com/download


インストール時のポイント：

✔ 「Add Anaconda to PATH」 → チェックしない（推奨）

✔ 「Just Me」 → OK

② 仮想環境を作成（1回だけ）

各自のPCで：

conda create -n mytool python=3.11
conda activate mytool
pip install -r \\fileserver\share\mytool\requirements.txt


👉 ここまでやれば 以降はbatだけでOK になります。

③ run.bat（共有サーバ上に配置）
@echo off
call "%USERPROFILE%\anaconda3\Scripts\activate.bat" mytool
python "%~dp0main.py"
pause

ポイント

%~dp0
👉 batのあるフォルダを自動参照
👉 ネットワークパスでもOK

pythonはAnaconda環境のものを使用

ーーーーーーコードーーーーーーrun.cmdーーーーーーー

@echo off

REM ==== 共有サーバ上のスクリプトのパス ====
set SCRIPT_PATH=\\fileserver\share\mytool\main.py

set CONDA_BAT=

if exist "%USERPROFILE%\anaconda3\Scripts\activate.bat" (
    set CONDA_BAT=%USERPROFILE%\anaconda3\Scripts\activate.bat
) else if exist "C:\ProgramData\anaconda3\Scripts\activate.bat" (
    set CONDA_BAT=C:\ProgramData\anaconda3\Scripts\activate.bat
) else if exist "C:\Anaconda3\Scripts\activate.bat" (
    set CONDA_BAT=C:\Anaconda3\Scripts\activate.bat
) else (
    echo Anacondaが見つかりません。Anacondaをインストールしてください。
    pause
    exit /b
)

call "%CONDA_BAT%" env0
REM == python "%~dp0..\main.py"
REM ==== Pythonスクリプト実行 ====
python "%SCRIPT_PATH%"


pause




--------------------------------------------------------------------------------

全体の流れ（まず結論）
開発PCに必要ライブラリをインストール
PyInstallerでexe化
生成されたexeを配布
👉 受け取る側は ダブルクリックするだけ
① 必要なライブラリは「どこで」管理する？
結論：exeを作るあなたのPC（開発環境）にだけ入っていればOKです。
配布先のPCには Pythonもライブラリも一切不要 です。
✔ 管理のベストプラクティス（おすすめ）
本番ツール用に 専用の仮想環境 を作るのが安全です。
コードをコピーする
Bash
python -m venv exe_env
exe_env\Scripts\activate
pip install -r requirements.txt
※ requirements.txt が無ければ：
コードをコピーする
Bash
pip freeze > requirements.txt
② PyInstallerのインストール
exe化用のツールです。
コードをコピーする
Bash
pip install pyinstaller
確認：
コードをコピーする
Bash
pyinstaller --version
③ exe化の基本コマンド（まずはこれだけでOK）
コードをコピーする
Bash
pyinstaller --onefile main.py
成功すると：
コードをコピーする
Text
dist/
 └ main.exe
👉 この main.exe を配布すればOKで
